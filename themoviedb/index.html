
<!doctype html>

<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  <meta charset="UTF-8">
  <title>TheMovieDb</title>
  <script src="../../bower_components/webcomponentsjs/webcomponents-lite.js"></script>
  <link rel="import" href="../../elements/codelab.html">
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400|Roboto:400,300,400italic,500,700|Roboto+Mono">
  <style is="custom-style">
    body {
      font-family: "Roboto",sans-serif;
      background: var(--google-codelab-background, #F8F9FA);
    }
  </style>
  
</head>
<body unresolved class="fullbleed">

  <google-codelab title="TheMovieDb"
                  environment="web"
                  feedback-link="https://github.com/gerardfp">
    
      <google-codelab-step label="Introducci√≥" duration="0">
        <p>El objetivo de esta pr√°ctica es trabajar con <strong>Fragments</strong>.</p>
<p>Un <a href="https://developer.android.com/reference/android/app/Fragment.html" target="_blank"><code>Fragment</code></a> representa un comportamiento o una parte de la interfaz de usuario en una <a href="https://developer.android.com/reference/android/app/Activity.html" target="_blank"><code>Activity</code></a>. Puedes combinar m√∫ltiples fragmentos en una sola actividad para crear una IU multipanel y volver a usar un fragmento en m√∫ltiples actividades. Puedes pensar en un fragmento como una secci√≥n modular de una actividad que tiene su ciclo de vida propio, recibe sus propios eventos de entrada y que puedes agregar o quitar mientras la actividad se est√© ejecutando (algo as√≠ como una &#34;subactividad&#34; que puedes volver a usar en diferentes actividades).</p>
<p>Realizaremos una aplicaci√≥n que mostrar√° una lista de pel√≠culas, descargadas de <a href="http://themoviedb.org" target="_blank">http://themoviedb.org</a></p>
<p><img style="max-width: 307.00px" src="img\143048db7a78f574.png"></p>
<p>Para poder consultar la api de TheMovieDB necesitar√°s una API_KEY, as√≠ que tienes que registrarte en la web y solicitarla.</p>
<p><em><code>92fd4bac1fb7ad2e8013081985bc9789</code></em></p>
<p>Aqu√≠ encontrar√°s el c√≥digo final de la aplicaci√≥n: <a href="https://github.com/gerardfp/TheMovieDb1" target="_blank">https://github.com/gerardfp/TheMovieDb1</a> </p>
<p><strong>‚è©Crea el proyecto</strong></p>
<p>Selecciona &#34;Empty Activity&#34; como plantilla para la actividad principal.</p>


      </google-codelab-step>
    
      <google-codelab-step label="Orientaci√≥n y tama√±o de la pantalla" duration="0">
        <p>Android permite de una forma sencilla tener distintos archivos de recursos dependiendo del tama√±o y la orientaci√≥n de la pantalla.</p>
<p>Para ello solo hay que a√±adir los cualificadores deseados en el momento de crear el archivo de recursos.</p>
<p>Por ejemplo, podemos tener dos versiones del layout <code>activity_main.xml</code>, una para la orientaci√≥n vertical de la pantalla (<em>portrait</em>) y otra para la veritcal (<em>landscape</em>).</p>
<p><strong>‚è©Crea un layout activity_main alternativo</strong></p>
<p>Crea un layout </p>
<pre>activity_main.xml</pre>
<p> alternativo para la orientaci√≥n horizontal de la pantalla</p>
<p>Selecciona <strong>New</strong> -&gt; <strong>Layout resource file</strong> e introduce el cualificador <strong>Orientation </strong>con el valor <strong>Landscape</strong>:</p>
<p><img style="max-width: 722.00px" src="img\93edd7f68f56cfcf.png"></p>
<p><strong>‚è©Dise√±a el layout </strong></p>
<pre>activity_main.xml (land)</pre>
<p>A√±ade, por ejemplo, un </p>
<pre>TextView</pre>
<p>:<br></p>
<pre><code>&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt;
&lt;android.support.constraint.ConstraintLayout xmlns:android=&#34;http://schemas.android.com/apk/res/android&#34;
   android:layout_width=&#34;match_parent&#34;
   android:layout_height=&#34;match_parent&#34;&gt;

   &lt;TextView
       android:layout_width=&#34;wrap_content&#34;
       android:layout_height=&#34;wrap_content&#34;
       android:text=&#34;Hello Horizontal World!&#34;
       app:layout_constraintBottom_toBottomOf=&#34;parent&#34;
       app:layout_constraintLeft_toLeftOf=&#34;parent&#34;
       app:layout_constraintRight_toRightOf=&#34;parent&#34;
       app:layout_constraintTop_toTopOf=&#34;parent&#34; /&gt;

&lt;/android.support.constraint.ConstraintLayout&gt;</code></pre>
<p><strong>üì≤ Prueba la aplicaci√≥n</strong></p>
<p>Observa c√≥mo al rotar la pantalla se intercambia entre el </p>
<pre>activity_main.xml</pre>
<p> y el </p>
<pre>activity_main.xml (land)</pre>
<p>Como has podido ver, calificadores para layouts alternativos hay bastantes. No solo para el tama√±o y orientaci√≥n de la pantalla, sino tambi√©n para el Codigo de Pa√≠s, Idioma, o Versi√≥n de Android.</p>
<p>En esta pr√°ctica trabajaremos solo con la orientaci√≥n, pero no ser√≠a nada dif√≠cil a√±adir un cualificador para adaptarlo al tama√±o de la pantalla, y as√≠ tener dos versiones diferentes, una para tablet y otra para m√≥vil, por ejemplo.</p>
<h2>Orientaci√≥n en runtime</h2>
<p>Para obtener la orientaci√≥n de la pantalla en <em>runtime </em>(es decir desde el c√≥digo Java), haremos un peque√±o truquito.</p>
<p>A√±adiremos dos ficheros de recursos de valores que llamaremos <code>config.xml</code>, uno de ellos con el calificador <em>landscape</em>. Dentro de los ficheros a√±adiremos un recurso booleano el cual ser√° <code>false</code> para la versi√≥n normal y <code>true</code> para la versi√≥n <em>landscape</em>.</p>
<p>Luego desde el c√≥digo Java, podemos obtener el valor del booleano, que ser√° <code>true</code> o <code>false</code>, en funci√≥n del fichero que haya cargado (que depender√° de la orientaci√≥n).</p>
<p><strong>‚è©Crea dos versiones alternativas del archivo config.xml</strong></p>
<p>Sobre la carpeta </p>
<pre>res/values</pre>
<p> selecciona <strong>New</strong> -&gt; <strong>Values resource file</strong>. Ponle el nombre de fichero</p>
<pre> config.xml</pre>
<p>. Repite la operaci√≥n a√±adiendo el cualificador <em>Landscape</em>.</p>
<p>En la versi√≥n normal a√±ade el siguiente item:</p>
<pre><code>&lt;resources&gt;
   &lt;item name=&#34;land&#34; type=&#34;bool&#34;&gt;false&lt;/item&gt;
&lt;/resources&gt;</code></pre>
<p>En la versi√≥n <em>land </em>dale el valor </p>
<pre>true</pre>
<pre><code>&lt;item name=&#34;land&#34; type=&#34;bool&#34;&gt;true&lt;/item&gt;</code></pre>
<p>De esta forma, ya que Android nos cargar√° un fichero u otro dependiendo de la orientaci√≥n de la pantalla, el valor del item &#34;land&#34;, ser√° </p>
<pre>true</pre>
<p> o </p>
<pre>false</pre>
<p>.</p>
<p><strong>‚è©Obt√©n el valor del item </strong><strong><em>land </em></strong><strong>en runtime</strong></p>
<p>Desde la </p>
<pre>ActivityMain</pre>
<p> podemos obtener el valor del √≠tem &#34;land&#34;, y as√≠ obtener la orientaci√≥n de la pantalla:</p>
<p>(<strong>A√±ade el </strong></p>
<pre>id</pre>
<p><strong> al TextView en las dos versiones del layout</strong>)<br></p>
<pre><code>public class MainActivity extends AppCompatActivity {

   @Override
   protected void onCreate(Bundle savedInstanceState) {
       super.onCreate(savedInstanceState);
       setContentView(R.layout.activity_main);

       TextView textView = findViewById(R.id.textView);
       if(isLandscape()){
           textView.setText(&#34;Hello Landscape Runtime World!&#34;);
       }else{
           textView.setText(&#34;Hello Runtime World!&#34;);
       }
   }

   boolean isLandscape(){
       return getResources().getBoolean(R.bool.land);
   }
}</code></pre>
<p><strong>üì≤ Prueba la aplicaci√≥n</strong></p>
<p>Observa c√≥mo en <em>runtime</em> se establece un texto u otro en el </p>
<pre>TextView</pre>
<p> dependiendo de la orientaci√≥n</p>


      </google-codelab-step>
    
      <google-codelab-step label="Fragments" duration="0">
        <p>Nuestra aplicaci√≥n va seguir el dise√±o Master/Detail. </p>
<p>La secci√≥n Master mostrar√° la lista de peliculas, y la secci√≥n Detail mostrar√° los detalles de la pel√≠cula seleccionada.</p>
<p>Haremos dos versiones seg√∫n la orientaci√≥n. En la versi√≥n <strong>Landscape</strong> se mostrar√°n al mismo tiempo la lista (<em>Master</em>) y el detalle (<em>Detail</em>). En la versi√≥n <strong>Portrait</strong> se mostrar√°n en Activities diferentes.</p>
<p><img style="max-width: 493.70px" src="img\ac213e1fc0e7aa28.png"></p>
<p>De momento, solo nos centraremos en la disposici√≥n de los Fragments, as√≠ que en lugar de la lista y la informaci√≥n de las pel√≠culas a√±adiremos un <code>Button</code> en el Master y un <code>TextView</code> en el Detail. <strong>Cuando se haga click en el bot√≥n, cambiaremos el texto del </strong><strong><code>TextView</code></strong><strong>.</strong> En la versi√≥n <em>Landscape</em>, los dos fragments estar√°n en la <code>MainActivity</code>. En la versi√≥n <em>Portrait</em> iniciaremos una nueva Activity para el Detail.</p>
<p><img style="max-width: 576.50px" src="img\a9357572105d42f9.png"></p>
<p><strong>‚è©Crea el MainFragment</strong></p>
<p>Crea un nuevo fichero de layout llamado </p>
<pre>fragment_main.xml</pre>
<p>A√±ade el </p>
<pre>Button</pre>
<pre><code>&lt;Button
   android:id=&#34;@+id/button&#34;
   android:layout_width=&#34;wrap_content&#34;
   android:layout_height=&#34;wrap_content&#34;
   android:text=&#34;Button&#34; /&gt;</code></pre>
<p>Crea la clase </p>
<pre>MainFragment</pre>
<pre><code>public class MainFragment extends Fragment {
   @Override
   public View onCreateView(LayoutInflater inflater, ViewGroup container,
                            Bundle savedInstanceState) {
       super.onCreateView(inflater, container, savedInstanceState);
       View mView = inflater.inflate(R.layout.fragment_main, container, false);

       return mView;
   }
}</code></pre>
<p>(Importa la clase </p>
<pre><code>android.app.Fragment</code></pre>
<p>)</p>
<p><strong>‚è©Crea el DetailFragment</strong></p>
<p>Crea un nuevo fichero de layout llamado </p>
<pre>fragment_detail.xml</pre>
<p>A√±ade el </p>
<pre>TextView</pre>
<pre><code>&lt;TextView
   android:id=&#34;@+id/textView&#34;
   android:layout_width=&#34;wrap_content&#34;
   android:layout_height=&#34;wrap_content&#34;
   android:text=&#34;TextView&#34; /&gt;</code></pre>
<p>Crea la clase </p>
<pre>DetailFragment</pre>
<pre><code>public class DetailFragment extends Fragment {
   @Override
   public View onCreateView(LayoutInflater inflater, ViewGroup container,
                            Bundle savedInstanceState) {
       super.onCreateView(inflater, container, savedInstanceState);
       View mView = inflater.inflate(R.layout.fragment_detail, container, false);

       return mView;
   }
}</code></pre>
<p><strong>‚è©Modifica el layout ActivityMain</strong></p>
<p>Para la versi√≥n normal, haz que incluya solo el </p>
<pre>MainFragment</pre>
<pre><code>&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt;
&lt;android.support.constraint.ConstraintLayout xmlns:android=&#34;http://schemas.android.com/apk/res/android&#34;
   android:layout_width=&#34;match_parent&#34;
   android:layout_height=&#34;match_parent&#34;&gt;

   &lt;fragment
       android:id=&#34;@+id/fragmentMain&#34;
       android:name=&#34;com.example.gerard.p07.MainFragment&#34;
       android:layout_width=&#34;match_parent&#34;
       android:layout_height=&#34;match_parent&#34; /&gt;

&lt;/android.support.constraint.ConstraintLayout&gt;</code></pre>
<p>Para la versi√≥n <em>landscape</em>, incluye los dos fragments</p>
<pre><code>&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt;
&lt;android.support.constraint.ConstraintLayout xmlns:android=&#34;http://schemas.android.com/apk/res/android&#34;
   android:layout_width=&#34;match_parent&#34;
   android:layout_height=&#34;match_parent&#34;&gt;

   &lt;LinearLayout
       android:layout_width=&#34;match_parent&#34;
       android:layout_height=&#34;match_parent&#34;
       android:orientation=&#34;horizontal&#34;&gt;
       &lt;fragment
           android:id=&#34;@+id/fragmentMain&#34;
           android:name=&#34;com.example.gerard.p07.MainFragment&#34;
           android:layout_width=&#34;0dp&#34;
           android:layout_weight=&#34;2&#34;
           android:layout_height=&#34;match_parent&#34; /&gt;

       &lt;fragment
           android:id=&#34;@+id/fragmentDetail&#34;
           android:name=&#34;com.example.gerard.p07.DetailFragment&#34;
           android:layout_width=&#34;0dp&#34;
           android:layout_weight=&#34;3&#34;
           android:layout_height=&#34;match_parent&#34; /&gt;
   &lt;/LinearLayout&gt;
&lt;/android.support.constraint.ConstraintLayout&gt;</code></pre>
<p>** Borra la prueba anterior con el </p>
<pre>TextView </pre>
<p>en la </p>
<pre>MainActivity</pre>
<pre><code>TextView textView = findViewById(R.id.textView);
if(isLandscape()){
   textView.setText(&#34;Hello Landscape Runtime World!&#34;);
}else{
   textView.setText(&#34;Hello Runtime World!&#34;);
}</code></pre>
<p><strong>üì≤ Prueba la aplicaci√≥n</strong></p>
<p>Observa c√≥mo en <em>Landscape</em> aparecen los dos Fragment (Main y Detail), y en cambio, en modo <em>Portrait</em> solo aparece el Main.</p>
<h2>Comunicaci√≥n entre Fragments</h2>
<p>En este apartado veremos c√≥mo se pueden pasar datos, un String por ejemplo, de un Fragment a otro.</p>
<p>Necesitamos que cuando se haga click en el bot√≥n, el <code>MainFragment</code> env√≠e un <code>TEXTO</code> al <code>DetailFragment</code> para que lo muestre en el <code>TextView</code>. La comunicaci√≥n entre Fragments ser√° diferente seg√∫n la orientaci√≥n:</p>
<ul>
<li><strong>Portrait</strong>: el MainFragment iniciar√° la <code>DetailActivity</code>, y le pasar√° le <code>TEXTO</code> en el <code>Intent</code>. El <code>DetailFragment</code> recuperar√° el <code>Intent</code> y de ah√≠ sacar√° el <code>TEXTO</code>.</li>
<li><strong>Landscape</strong>: el <code>MainFragment</code> ejecutar√° un m√©todo de la <code>MainActivity</code> y le pasar√° el <code>TEXTO</code> como par√°metro. La <code>MainActivity</code> a su vez, ejecutar√° otro m√©todo del <code>DetailFragment</code>, pas√°ndole el <code>TEXTO</code>.</li>
</ul>
<h3>Portrait</h3>
<p>A√±adiremos un listener al bot√≥n, para que inicie la <code>DetailActivity</code>, y le pase un texto en el <code>Intent</code>.</p>
<p>La <code>DetailActivity</code> incluye el <code>DetailFragment</code>, quien pondr√° en el <code>TextView</code> el texto sacado del <code>Intent</code>.</p>
<p><img style="max-width: 467.00px" src="img\855996ec62ca28ec.png"></p>
<p><strong>‚è©A√±ade el Listener al bot√≥n</strong></p>
<p>En la clase  </p>
<pre>MainFragment </pre>
<p>a√±ade un </p>
<pre>OnClickListener</pre>
<p> al bot√≥n:</p>
<pre><code>@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
                         Bundle savedInstanceState) {
   super.onCreateView(inflater, container, savedInstanceState);
   View mView = inflater.inflate(R.layout.fragment_main, container, false);

   mView.findViewById(R.id.button).setOnClickListener(new View.OnClickListener() {
      @Override
      public void onClick(View view) {
         Intent intent = new Intent(getActivity(), DetailActivity.class);
         intent.putExtra(&#34;TEXT&#34;, &#34;Hello fragment communication!&#34;);
         startActivity(intent);
      }
   });

   return mView;
}</code></pre>
<p><strong>‚è©Crea la DetailActivity</strong></p>
<p>Crea un nueva &#34;Empty Activity&#34; con el nombre </p>
<pre>DetailActivity</pre>
<p>En la layout de la </p>
<pre>DetailActivity</pre>
<p> (</p>
<pre>activity_detail.xml</pre>
<p>) a√±ade el fragment  </p>
<pre>DetailFragment</pre>
<pre><code>&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt;
&lt;android.support.constraint.ConstraintLayout xmlns:android=&#34;http://schemas.android.com/apk/res/android&#34;
   android:layout_width=&#34;match_parent&#34;
   android:layout_height=&#34;match_parent&#34;&gt;

   &lt;fragment
       android:id=&#34;@+id/fragmentDetail&#34;
       android:name=&#34;com.example.gerard.p07.DetailFragment&#34;
       android:layout_width=&#34;0dp&#34;
       android:layout_weight=&#34;3&#34;
       android:layout_height=&#34;match_parent&#34; /&gt;

&lt;/android.support.constraint.ConstraintLayout&gt;</code></pre>
<p><strong>‚è©Haz que el DetailFragment cambie el TextView</strong></p>
<p>Pon el siguiente c√≥digo en la clase  </p>
<pre>DetailFragment </pre>
<p>para que saque el texto del </p>
<pre>Intent </pre>
<p>y lo establezca en el </p>
<pre>TextView</pre>
<p>.</p>
<pre><code>public class DetailFragment extends Fragment {
   View mView;

   @Override
   public View onCreateView(LayoutInflater inflater, ViewGroup container,
                            Bundle savedInstanceState) {
       super.onCreateView(inflater, container, savedInstanceState);
       mView = inflater.inflate(R.layout.fragment_detail, container, false);

       Intent intent = getActivity().getIntent();
       String text = intent.getStringExtra(&#34;TEXT&#34;);
       updateTextView(text);

       return mView;
   }

   void updateTextView(String text){
       ((TextView) mView.findViewById(R.id.textView)).setText(text);
   }
}</code></pre>
<p><strong>üì≤ Prueba la aplicaci√≥n</strong></p>
<p>Observa c√≥mo al hacer click en el bot√≥n se abre la </p>
<pre>DetailActivity</pre>
<p> y se establece el </p>
<pre>TEXTO</pre>
<p> enviado. (De momento esto lo hace tanto en <em>Landscape</em> como en <em>Portrait</em>. A continuaci√≥n haremos la discriminaci√≥n)</p>
<h3>Landscape</h3>
<p>Para la comunicaci√≥n entre Fragments dentro de una misma Activity, se utilizan Listeners.</p>
<p>Haremos que cuando se haga click en el bot√≥n, la <code>MainFragment</code> ejecute un m√©todo de la <code>MainActivity</code>, y le pase como parametro el <code>TEXT</code>. Para ello, la <code>MainActivity</code> debe establecerse como listener de la <code>MainFragment</code>.</p>
<p>Luego, la <code>MainActivity</code> ejecutar√° un m√©todo de la <code>DetailFragment</code>, pas√°ndole el <code>TEXT.</code></p>
<p><img style="max-width: 404.65px" src="img\da43db8808ee2a07.png"></p>
<p><strong>‚è©Define el interfaz OnButtonClickListener</strong></p>
<p>En la clase  </p>
<pre>MainFragment</pre>
<p> crea el interfaz </p>
<pre>OnButtonClickListener</pre>
<p>:</p>
<pre><code>public class MainFragment extends Fragment {
   interface OnButtonClickListener {
       void onButtonClick(String text);
   }

    . . . .
}</code></pre>
<p><strong>‚è©Haz que la MainActivity implemente el interface OnButtonClickListener</strong></p>
<p>En el m√©todo </p>
<pre>onButtonClick()</pre>
<p>, la </p>
<pre>MainActivity</pre>
<p> ejecutar√° el m√©todo </p>
<pre>updateTextView()</pre>
<p> de la </p>
<pre>DetailFragment</pre>
<pre><code>public class MainActivity extends AppCompatActivity implements MainFragment.OnButtonClickListener{

   @Override
   protected void onCreate(Bundle savedInstanceState) {
       super.onCreate(savedInstanceState);
       setContentView(R.layout.activity_main);
   }

   @Override
   public void onButtonClick(String text) {
       if(isLandscape()) {
           DetailFragment fragment = (DetailFragment) getFragmentManager().findFragmentById(R.id.fragmentDetail);
           fragment.updateTextView(text);
       }else {
           Intent intent = new Intent(this, DetailActivity.class);
           intent.putExtra(&#34;TEXT&#34;, text);
           startActivity(intent);
       }
   }
}</code></pre>
<p><strong>‚è©Establece la MainActivity como listener del evento OnButtonClick</strong></p>
<p>En el callback </p>
<pre>onAttach()</pre>
<p> del </p>
<pre>MainFragment</pre>
<p>, guardamos la </p>
<pre>MainActivity</pre>
<p> como </p>
<pre><code>listener</code></pre>
<p> para el evento </p>
<pre>OnButtonClick</pre>
<p>.</p>
<p>Cuando se haga click en el bot√≥n haremos que se ejecute el m√©todo </p>
<pre>onButtonClick()</pre>
<p> de la </p>
<pre>MainActivity</pre>
<pre><code>public class MainFragment extends Fragment {

   interface OnButtonClickListener {
       void onButtonClick(String text);
   }

   OnButtonClickListener mListener; // el listener ser√° la MainActivity

   @Override
   public View onCreateView(LayoutInflater inflater, ViewGroup container,
                            Bundle savedInstanceState) {
       super.onCreateView(inflater, container, savedInstanceState);
       View mView = inflater.inflate(R.layout.fragment_main, container, false);

       mView.findViewById(R.id.button).setOnClickListener(new View.OnClickListener() {
           @Override
           public void onClick(View view) {
               mListener.onButtonClick(&#34;Hello fragment communication!&#34;);
           }
       });
       return mView;
   }

   @Override
   public void onAttach(Context context) {
       super.onAttach(context);
       try {
           mListener = (OnButtonClickListener) context; // context==MainActivity
       } catch (ClassCastException e) {
           throw new ClassCastException(context.toString() + &#34; must implement OnButtonClickListener&#34;);
       }
   }
}</code></pre>
<p><strong>üì≤ Prueba la aplicaci√≥n</strong></p>
<p>Ahora, en modo <em>Landscape</em>, el </p>
<pre>TEXTO</pre>
<p> se env√≠a al </p>
<pre>DetailFragment</pre>
<p> de la </p>
<pre>MainActivity</pre>
<p>.</p>
<h2>ViewPager y TabLayout</h2>
<p>Ahora haremos que el <code>MainFragment</code> incluya un Barra con Tabs para poder desplazarnos entre tres Fragments diferentes</p>
<p><img style="max-width: 327.22px" src="img\f98ba27ed44d176b.png"></p>
<p>Para hacer esto android provee las clases <code>FragmentPagerAdapter</code>, <code>ViewPager</code> y <code>TabLayout</code></p>
<p><strong>‚è©A√±ade las bibliotecas</strong></p>
<p>En el </p>
<pre>build.gradle (app)</pre>
<p>,  a√±ade las siguientes bibliotecas:<br></p>
<pre><code>implementation &#39;com.android.support:design:26.1.0&#39;
implementation &#39;com.android.support:support-v13:26.1.0&#39;</code></pre>
<p><strong>‚è©Crea tres Fragments</strong></p>
<p>Ll√°malos  </p>
<pre>FirstFragment</pre>
<p>, </p>
<pre>SecondFragment</pre>
<p>, y </p>
<pre>ThirdFragment</pre>
<p>A√±ade en el layout de cada fragment un contenido diferente... el que desees</p>
<p><strong>‚è©A√±ade el TabLayout y el ViewPager en el FragmentMain</strong></p>
<p>Pon el siguiente xml en el </p>
<pre><code>fragment_main.xml
</code></pre>
<pre><code>&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt;
&lt;RelativeLayout xmlns:android=&#34;http://schemas.android.com/apk/res/android&#34;
   android:layout_width=&#34;match_parent&#34;
   android:layout_height=&#34;match_parent&#34;&gt;

   &lt;android.support.design.widget.TabLayout
       android:id=&#34;@+id/tabLayout&#34;
       android:layout_width=&#34;match_parent&#34;
       android:layout_height=&#34;wrap_content&#34; /&gt;

   &lt;android.support.v4.view.ViewPager
       android:id=&#34;@+id/viewPager&#34;
       android:layout_width=&#34;match_parent&#34;
       android:layout_height=&#34;match_parent&#34;
       android:layout_below=&#34;@id/tabLayout&#34;/&gt;

&lt;/RelativeLayout&gt;</code></pre>
<p><strong>‚è©Configura el FragmentPagerAdapter</strong></p>
<p>En la clase </p>
<pre><code>MainFragment </code></pre>
<p>cambia el callback </p>
<pre><code>onCreateView()</code></pre>
<p> por el siguiente:</p>
<pre><code></code></pre>
<pre><code>@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
                        Bundle savedInstanceState) {
   super.onCreateView(inflater, container, savedInstanceState);
   View mView = inflater.inflate(R.layout.fragment_main, container, false);

   FragmentPagerAdapter mPagerAdapter = new FragmentPagerAdapter(getFragmentManager()) {
      private final Fragment[] mFragments = new Fragment[] {
              new FirstFragment(),
              new SecondFragment(),
              new ThirdFragment(),
      };
      private final String[] mFragmentNames = new String[] {
              &#34;First&#34;,
              &#34;Second&#34;,
              &#34;Third&#34;
      };
      @Override
      public Fragment getItem(int position) {
          return mFragments[position];
      }
      @Override
      public int getCount() {
          return mFragments.length;
      }
      @Override
      public CharSequence getPageTitle(int position) {
          return mFragmentNames[position];
      }
   };

   ViewPager mViewPager = (ViewPager) mView.findViewById(R.id.viewPager);
   mViewPager.setAdapter(mPagerAdapter);
   TabLayout tabLayout = (TabLayout) mView.findViewById(R.id.tabLayout);
   tabLayout.setupWithViewPager(mViewPager);

   return mView;
}</code></pre>
<p>** Importa las siguientes librer√≠as:</p>
<pre><code>import android.app.Fragment;
import android.support.design.widget.TabLayout;
import android.support.v13.app.FragmentPagerAdapter;
import android.support.v4.view.ViewPager;</code></pre>
<p><strong>üì≤ Prueba la aplicaci√≥n</strong></p>
<p><strong>‚è©Challenge: </strong></p>
<p>A√±ade un bot√≥n en cada fragment, y haz que cuando se haga click, cada uno ejecute el callback </p>
<pre>onButtonClick()</pre>
<p> de la </p>
<pre>MainActivity</pre>
<p>, pas√°ndole un texto diferente. La </p>
<pre>MainActivity</pre>
<p> lo enviar√° al </p>
<pre>DetailFragment</pre>
<p> para que lo muestre.</p>


      </google-codelab-step>
    
      <google-codelab-step label="Extensi√≥n de fragments" duration="0">
        <p>En la prueba anterior, cada fragment ten√≠a un contenido diferente, sin embargo, para la App de pel√≠culas los tres fragments contienen lo mismo: un RecyclerView. Lo √∫nico que cambia entre ellos es el ArrayList de pel√≠culas con que se ha de rellenar ese RecyclerView.</p>
<p>Ser√≠a absurdo, en este caso, poner un RecyclerView diferente en cada uno de los tres fragments. As√≠ que optaremos por hacer un fragment gen√©rico con el RecyclerView, y hacer que los tres fragments extiendan del gen√©rico, y solamente implementen el c√≥digo que rellena el ArrayList.</p>
<p><img style="max-width: 483.70px" src="img\d6a5300962b1b447.png"></p>
<p>De momento, los fragment rellenar√°n el ArrayList con <strong>datos de prueba</strong>, m√°s adelante haremos que cada uno lo rellene con las pel√≠culas correspondientes.</p>
<p><strong>‚è©Crea el ListFragment</strong></p>
<p>En su archivo de layout, </p>
<pre>fragment_list.xml</pre>
<p>,  a√±ade el </p>
<pre>RecyclerView</pre>
<p>:<br></p>
<pre><code>&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt;
&lt;android.support.constraint.ConstraintLayout
   xmlns:android=&#34;http://schemas.android.com/apk/res/android&#34;
   android:layout_width=&#34;match_parent&#34;
   android:layout_height=&#34;match_parent&#34;&gt;

   &lt;android.support.v7.widget.RecyclerView
       android:id=&#34;@+id/recyclerView&#34;
       android:layout_width=&#34;match_parent&#34;
       android:layout_height=&#34;match_parent&#34; /&gt;

&lt;/android.support.constraint.ConstraintLayout&gt;</code></pre>
<p>En la clase </p>
<pre>ListFragment</pre>
<p> configuramos el </p>
<pre>RecyclerView</pre>
<p>:</p>
<ul>
<li>Definimos el LayoutManager: Lineal</li>
<li>Creamos el ArrayList para almacenar los items</li>
<li>Definimos el Adaptador</li>
<li>Definimos el interfaz para el Listener del evento OnItemSelected</li>
<li>Declaramos abstracto el m√©todo que rellena el ArrayList, para que sean las subclases los que lo implementen</li>
</ul>
<pre><code>public abstract class ListFragment extends Fragment {

   public interface OnItemSelectedListener {
       void onItemSelected(String text);
   }

   OnItemSelectedListener mListener;
   private RecyclerView mRecycler;
   RecyclerAdapter mRecyclerAdapter;
   ArrayList&lt;String&gt; items = new ArrayList&lt;&gt;();

   @Override
   public View onCreateView(LayoutInflater inflater, ViewGroup container,
                            Bundle savedInstanceState) {
       super.onCreateView(inflater, container, savedInstanceState);
       View mView = inflater.inflate(R.layout.fragment_list, container, false);

       mRecycler = (RecyclerView) mView.findViewById(R.id.recyclerView);
       mRecycler.setLayoutManager(new LinearLayoutManager(getActivity()));
       mRecycler.setHasFixedSize(true);

       mRecyclerAdapter = new RecyclerAdapter(items);
       mRecycler.setAdapter(mRecyclerAdapter);

       populateList();

       return mView;
   }

   @Override
   public void onAttach(Context context) {
       super.onAttach(context);
       try {
           mListener = (OnItemSelectedListener) context;
       } catch (ClassCastException e) {
           throw new ClassCastException(context.toString() + &#34; must implement OnItemSelectedListener&#34;);
       }
   }

   public abstract void populateList();

   class RecyclerAdapter extends RecyclerView.Adapter&lt;RecyclerAdapter.ItemViewHolder&gt; {

       private List&lt;String&gt; items;

       RecyclerAdapter(List&lt;String&gt; items) {
           this.items = items;
       }

       @Override
       public ItemViewHolder onCreateViewHolder(ViewGroup viewGroup, int i) {
           View view = LayoutInflater.from(viewGroup.getContext()).inflate(R.layout.item, viewGroup,false);
           return new ItemViewHolder(view);
       }

       @Override
       public void onBindViewHolder(final ItemViewHolder viewHolder, int i) {
           final String item = items.get(i);

           viewHolder.title.setText(item);

           viewHolder.itemView.setOnClickListener(new View.OnClickListener() {
               @Override
               public void onClick(View view) {
                   mListener.onItemSelected(item);
               }
           });
       }

       @Override
       public int getItemCount() {
           return (items != null ? items.size() : 0);
       }

       class ItemViewHolder extends RecyclerView.ViewHolder {
           private TextView title;

           ItemViewHolder(View view) {
               super(view);
               this.title = (TextView) view.findViewById(R.id.title);
           }
       }
   }
}</code></pre>
<p>Creamos el layout (</p>
<pre>item.xml</pre>
<p>) que har√° de ViewHolder para cada √≠tem de la lista:</p>
<pre><code>&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt;
&lt;android.support.constraint.ConstraintLayout
   xmlns:android=&#34;http://schemas.android.com/apk/res/android&#34;
   android:layout_width=&#34;match_parent&#34;
   android:layout_height=&#34;wrap_content&#34;&gt;

   &lt;TextView
       android:id=&#34;@+id/title&#34;
       android:layout_width=&#34;match_parent&#34;
       android:layout_height=&#34;wrap_content&#34; /&gt;

&lt;/android.support.constraint.ConstraintLayout&gt;</code></pre>
<p><strong>‚è©Extiende el ListFragment</strong></p>
<p>Modificamos los </p>
<pre>FirstFragment</pre>
<p>, </p>
<pre>SecondFragment </pre>
<p>y </p>
<pre>ThirdFragment </pre>
<p>para que extiendan el </p>
<pre>ListFragment</pre>
<p>, e implementamos en cada uno el m√©todo </p>
<pre>populateList()
FirstFragment</pre>
<pre><code>public class FirstFragment extends ListFragment {

   @Override
   public void populateList() {

       items.clear();

       for(int i=0; i&lt;100; i++){
           items.add(&#34;FIRST FRAGMENT &#34; + i);
       }

       mRecyclerAdapter.notifyDataSetChanged();
   }
}</code></pre>
<pre>SecondFragment</pre>
<pre><code>public class SecondFragment extends ListFragment {

   @Override
   public void populateList() {

       items.clear();

       for(int i=0; i&lt;100; i++){
           items.add(&#34;SECOND FRAGMENT &#34; + i);
       }

       mRecyclerAdapter.notifyDataSetChanged();
   }
}</code></pre>
<pre>ThirdFragment</pre>
<pre><code>public class ThirdFragment extends ListFragment {

   @Override
   public void populateList() {

       items.clear();

       for(int i=0; i&lt;100; i++){
           items.add(&#34;THIRD FRAGMENT &#34; + i);
       }

       mRecyclerAdapter.notifyDataSetChanged();
   }
}</code></pre>
<p><strong>‚è©Implementamos el interface OnItemSelectedListener en la MainActivity</strong></p>
<p>La </p>
<pre>MainActivity</pre>
<p> queda as√≠:</p>
<pre><code>public class MainActivity extends AppCompatActivity implements ListFragment.OnItemSelectedListener{

   @Override
   protected void onCreate(Bundle savedInstanceState) {
       super.onCreate(savedInstanceState);
       setContentView(R.layout.activity_main);
   }

   boolean isLandscape(){
       return getResources().getBoolean(R.bool.land);
   }

   @Override
   public void onItemSelected(String text) {
       if(isLandscape()) {
           DetailFragment fragment = (DetailFragment) getFragmentManager().findFragmentById(R.id.fragmentDetail);
           fragment.updateTextView(text);
       }else {
           Intent intent = new Intent(this, DetailActivity.class);
           intent.putExtra(&#34;TEXT&#34;, text);
           startActivity(intent);
       }
   }
}</code></pre>
<p><strong>‚è©Code CleanUp</strong></p>
<p>Ahora los fragments First, Second y Third cogen el layout </p>
<pre>fragment_list.xml</pre>
<p>, as√≠ que ya no necesitamos sus archivos de layout: <strong>elimina </strong></p>
<pre>fragment_first.xml</pre>
<p>, </p>
<pre>fragment_second.xml</pre>
<p> y </p>
<pre>fragment_third.xml</pre>
<p>Tampoco tenemos los botones en los fragments, as√≠ que la </p>
<pre>MainActivity</pre>
<p> ya no implementa el interfaz </p>
<pre>OnButtonClickListener</pre>
<p>: <strong>elimina</strong> la definici√≥n del interface </p>
<pre>OnButtonClickListener</pre>
<p> del </p>
<pre>MainFragment</pre>
<p>, y tambi√©n el m√©todo </p>
<pre>onAttach()</pre>
<p> que establec√≠a la </p>
<pre>MainActivity</pre>
<p> como listener.</p>
<p><strong>üì≤ Prueba la aplicaci√≥n</strong></p>


      </google-codelab-step>
    
  </google-codelab>

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-49880327-14', 'auto');

    (function() {
      var gaCodelab = '';
      if (gaCodelab) {
        ga('create', gaCodelab, 'auto', {name: 'codelab'});
      }

      var gaView;
      var parts = location.search.substring(1).split('&');
      for (var i = 0; i < parts.length; i++) {
        var param = parts[i].split('=');
        if (param[0] === 'viewga') {
          gaView = param[1];
          break;
        }
      }
      if (gaView && gaView !== gaCodelab) {
        ga('create', gaView, 'auto', {name: 'view'});
      }
    })();
  </script>

</body>
</html>
