<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js"></script>
<script type="module" src="/sofi/js/script.js"></script>
<link rel="stylesheet" href="/sofi/css/estil.css">

<nav></nav>
<header>
    <h1>Servidor web NGINX</h1>

    <abstract>
        <p>
            En aquesta pràctica ens iniciarem amb les tecnologies que s'utilitzen per al desenvolupament
            d'aplicacions web.
        </p>
    </abstract>

    <form>
        <input type="text" name="replace-IP_SERVIDOR" placeholder="Introdueix la IP del teu servidor web">
        <input type="submit">
    </form>
</header>

<section>
    <h2>World Wide Web</h2>

    <p>El científic anglés <a href="https://ca.wikipedia.org/wiki/Tim_Berners-Lee">Tim Berners-Lee</a> 
        va inventar la World Wide Web (WWW), Xarxa d'Abast Mundial, en 1989, mentre treballava al CERN.
    </p>
    <p>Coneguda comunament com la Web, és un sistema
        d'informació on documents i altres recursos són identificats amb URLs (Uniform Resource Locators),
        com, per exemple, <url>http://wikipedia.org</url>, que poden ser enllaçats amb 
        <a href="https://ca.wikipedia.org/wiki/Hipertext">hypertext</a>, i són accessibles a través 
        d'Internet.
        <br>Els recrsos de la Web són transferits pels Servidors Web via l'
        <a href="https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol">Hypertext Transfer Protocol</a> 
        (HTTP) i es pot accedir a ells utilitzant el Navegador Web.
    </p>
</section>

<section>
    <h2>URL</h2>

    <p>Com hem dit, les URLs són identificadors de recursos. Els recursos poden ser molt diversos: pàgines,
        imatges, videos, fitxers, etcètera. Per exemple:</p>
    
    <ul>
        <li><p>La url <url>http://info.cern.ch/</url> identifica la pàgina principal del CERN</p></li>
        <li><p>La url <url>https://upload.wikimedia.org/wikipedia/commons/f/f8/Tim_Berners-Lee.jpg</url>
        identifica una imatge (de Tim, és clar)</p></li>
        <li>La url <url>https://upload.wikimedia.org/wikipedia/commons/a/a3/Tim_Berners_Lee_changed_the_world_25_years_ago_-_Tim_Berners_Lee.webm</url>
            identifica un vídeo.<p></p></li>
    </ul>

    <p>Una URL es compon de 7 components:</p>

    <img src="img/url_syntax.png">

    <ul>
        <li><name>Scheme</name>: defineix el protocol d'accés al document 
            (<tech>http</tech>, <tech>https</tech>, <tech>ftp</tech>, <tech>mailto</tech>, <tech>file</tech>, <tech>data</tech>)</li>
        <li><name>User</name>: la identifiació de l'usuari que accedeix al recurs</li>
        <li><name>Host</name>: l'adreça IP o el nom DNS del servidor</li>
        <li><name>Port</name>: El port del servidor al qual es connecta</li>
        <li><name>Path</name>: Identifica el recurs al qual es vol accedir</li>
        <li><name>Query</name>: Dades addicionals sobre el recurs</li>
        <li><name>Fragment</name>: Localització a dintre del propi recurs</li>
    </ul>

    Anem a veure amb més detall aquests components.

    <h3>Scheme</h3>
    <p>El protocol d'accés al recurs indica la forma concreta en que s'han de
        comunicar el que fa la petició i el que la respón.</p>
    
    <p>Per exemple, el protocol <tech>http</tech> serveix per a comunicar
        amb un servidor web. La especificacio del protocol és molt extensa, però podem veure un
        exemple senzill.</p>
    <p>En la seva forma més utilitzada, HTTP serveix per a obtenir recursos.</p>
    <p>Suposem que volem obtenir la pàgina principal del CERN. Aleshores, hem de realitzar
        un petició HTTP al seu servidor (<tech>info.cern.ch</tech>). Les dades que enviarem al servidor han de seguir
        exactament el protocol.
    </p>

    <p>Utilitzarem el programa <w>nc</w> per a comunicar amb el servidor del CERN.</p>

    <p>Obre un terminal i executa la següent comanda:</p>

    
        <host>@host</host>
        <shell>
            nc info.cern.ch 80
        </shell>
    

    <p>Amb aquesta comanda hem connectat al port <tech>80</tech> del servidor del CERN.
        <br>Ara el servidor està esperant que li enviem dades.</p>
    <p>Si enviem qualsevol dada al servidor, aquest no serà capaç de comprendre la petició.
        Li hem de enviar les dades adequades, seguint el protocol HTTP.
    </p>
    <p>Prova a escriure alguna cosa, i polsa <kbd>Intro</kbd> per a enviar les dades al servidor.</p>
    <p>El servidor respondrà amb un error <tech>400 (Bad request)</tech>. La petició no ha estat correcta.</p>

    <img src="img/bad_request.png">

    <p>Per a fer la petició correcta hem fer el següent:</p>
    <ol>
        <li>
            <p>Connectem amb el servidor:</p>
            <shell>
                nc info.cern.ch 80
            </shell>    
        </li>
        <li>
            <p>Escrivim la comanda <w>GET</w>, 
                <br>després el recurs que volem <w>/index.html</w>
                <br>després la versió del protocol <w>HTTP/1.0</w>
                <br>després un "retorn de carro" <kbd>Ctrl + V</kbd> <kbd>Ctrl + M</kbd>
                <br>i per últim un "retorn de línia" <kbd>Intro</kbd>
            </p>
            <shell>            
                GET /index.html HTTP/1.0 <kbd>Ctrl + V</kbd> <kbd>Ctrl + M</kbd> <kbd>Intro</kbd>
            </shell>    
        </li>
        <li>
            <p>Especifiquem el Host al qual estem connectant
                <br>introduint <w>Host: info.cern.ch</w>
                <br>"retorn de carro" <kbd>Ctrl + V</kbd> <kbd>Ctrl + M</kbd>
                <br>i "retorn de línia" <kbd>Intro</kbd>
            </p>
            <shell>
                Host: info.cern.ch <kbd>Ctrl + V</kbd> <kbd>Ctrl + M</kbd> <kbd>Intro</kbd>
            </shell>
        </li>
        <li>
            <p>Indiquem al servidor que ha finalitzat la petició amb
                <br>"retorn de carro" <kbd>Ctrl + V</kbd> <kbd>Ctrl + M</kbd>
                <br>i "retorn de línia" <kbd>Intro</kbd>
            </p>
            <shell>
                <kbd>Ctrl + V</kbd> <kbd>Ctrl + M</kbd> <kbd>Intro</kbd>
            </shell>
        </li>
    </ol>

    <p>Aquest cop sí, el servidor ens respon amb <w>200 (OK)</w>, i 
    ens retorna el recurs solicitat.</p>

    <img src="img/ok_request.png">

    <info>
        Aquesta petició que hem realitzat a mà és exactament el que fa el navegador web
        quan introduim la URL <url>http://info.cern.ch</url> a la barra d'adreçes.

        <p>Pots comprovar-ho de la següent forma:
            <ol>
                <li><p>Obre una pestanya nova del Firefox</p></li>
                <li><p>Polsa <kbd>F12</kbd> per a obrir les 
                    <strong>Eines de desenvolupador</strong></p></li>
                <li><p>Ves a la pestanya <img src="img/red.png"></p></li>
                <li><p>Introdueix <url>http://info.cern.ch/index.html</url> 
                    a la barra d'adreçes i navega a la pàgina</p></li>
                <li><p>Firefox et mostrarà tots els recursos que està 
                    descarregant del servidor</p></li>
                <li><p>Selecciona el recurs <tech>index.html</tech></p></li>
                <li><p>A la pestanya lateral <img src="img/cabeceras.png">, baixa
                fins a <img src="img/cabeceras_peticion.png"> i activa l'opció
                    <img src="img/sin_procesar.png"></p>
                </li>
            </ol>
        </p>
        <p>Ahí pots veure tota la petició HTTP que s'ha realitzat:</p>
        <img src="img/firefox_request.png">
    </info>


    <h3>User</h3>
    <p>Alguns servidors requereixen d'autenticació amb usuari:contrasenya per a accedir 
        a certs recursos</p>
    </p>

    <p>Instal·larem el servidor NGINX i realitzarem el configurarem per a requerir usuari:contrasenya en l'accés.</p>

    <host>@server</host>
    <shell>
        apt install -y nginx
    </shell>
    <info>
        <p><a href="https://docs.nginx.com/nginx/admin-guide/security-controls/configuring-http-basic-authentication/">
            Restricting Access with HTTP Basic Authentication</a></p>
    </info>
    <p>Primer necessitarem instal·lar el paquet <w>apache2-utils</w>. Aquest paquet conté el programa <w>htpasswd</w> que permet
    emmagatzemar usuaris i contrasenyes en un arxiu.</p>

    <host>@server</host>
    <shell>apt install apache2-utils</shell>

    <p>Creem l'usuari <w>Joan</w>:</p>
        <host>@server</host>
        <shell>
            htpasswd -c /var/www/contrasenyes joan
        </shell>

    <p>Comprovem que s'ha creat l'usuari:</p>
        <host>@server</host>
        <shell>
            cat /var/www/contrasenyes
        </shell>


    <p>Obrim el fitxer de configuració del lloc per defecte d'NGINX:</p>    
        <host>@server</host>
        <shell>nano /etc/nginx/sites-enabled/default</shell>
    

    <p>Afegim les següents línies per a activar l'accés amb usuari/password:</p>

    <scfile>
        /etc/nginx/sites-enabled/default
    </scfile>
    <sc none>
        <low>
        server {
            ...
        </low>
        <add>
            auth_basic "Introdueix el teu usuari/password"
            auth_basic_user_file /var/www/contrasenyes
        </add>
        <low>
            ...
        }
        </low>
    </sc>


    <p>Per últim reiniciem el servidor NGINX:</p>

    <host>@server</host>
    <shell>systemctl restart nginx</shell>

    <p>Per a accedir a la pàgina web haurem d'especificar un usuari i contrasenya vàlids</p>

    <host>@host</host>
    <shell>wget http://joan:joanpass@<IP_SERVIDOR>192.168.122.79</IP_SERVIDOR></shell>

    <h3>Host</h3>
    <p>El host és l'adreça IP o nom DNS del servidor.</p>

    <p>Configurarem el servidor web per a que mostri dues pàgines diferents en funció del <w>Host</w> que se 
        li indiqui en la petició.</p>

    <info>
        <p>
            <a href="https://nginx.org/en/docs/http/server_names.html">
                Server names
            </a>
        </p>
    </info>
    <p>Crearem dues carpetes (<folder>aaa.com</folder> i <folder>bbb.com</folder>), 
        i en cadascuna d'elles posarem una web diferent</p>
    
        <host>@server</host>
        <shell>
            mkdir /var/www/html/aaa.com
            mkdir /var/www/html/bbb.com
            echo "&lt;h1&gt;welcome to aaa.com&lt;/h1&gt;" > /var/www/html/aaa.com/index.html
            echo "&lt;h1&gt;welcome to bbb.com&lt;/h1&gt;" > /var/www/html/bbb.com/index.html
        </shell>
    

    <p>Canviem la configuració d'NGINX per a que busqui els recursos que se li sol·licitin 
        en una carpeta o l'altra en funció del Host (<w>server_name</w>) que s'indiqui a la petició <w>http</w>:</p>
    <scfile>
        /etc/nginx/sites-enabled/default
    </scfile>
    <sc none>
        <low>
        server {
            ...
        }
        </low>
        <add>
        server {
            listen       80;
            server_name  aaa.com;
            root /var/www/html/aaa.com;
        }
        server {
            listen       80;
            server_name  bbb.com;
            root /var/www/html/bbb.com;
        }
        </add>
    </sc>


    <p>Realitzem dues peticions als diferents noms de <w>host</w>:</p>
    
        <host>@host</host>
        <shell>
            printf 'GET /index.html HTTP/1.0\r\nHost aaa.com\r\n\r\n' | nc <IP_SERVIDOR>IP_SERVIDOR</IP_SERVIDOR> 80
            printf 'GET /index.html HTTP/1.0\r\nHost bbb.com\r\n\r\n' | nc <IP_SERVIDOR>IP_SERVIDOR</IP_SERVIDOR> 80
        </shell>
    

    <p>Observa que segons el <w>Host</w> indicat a la petició, es retorna una web o l'altra.</p>

    <p>Si tractem de realitzar amb Firefox aquesta petició no ens serà possible. Si posem "aaa.com" o "bbb.com" a la
        barra d'adreces, Firefox tractarà de resoldre el nom DNS i no podrà. I si posem la IP del servidor web a la barra
        d'adreces, aleshores no estarem especificant el host a la petició.
        <br>
        Podem fer un <i>apanyo</i> temporal, i posar la resolucio dels noms "aaa.com" i "bbb.com" al fitxer <w>/etc/hosts</w>:
    </p>

    <shell>
        sudo nano /etc/hosts
    </shell>

    <scfile>
        /etc/hosts
    </scfile>
    <sc>
        <low>
        ...    
        </low>
        <add>
        <IP_SERVIDOR></IP_SERVIDOR>  aaa.com
        <IP_SERVIDOR></IP_SERVIDOR>  bbb.com
        </add>
    </sc>
    

    <h3>Port</h3>

    <p>NGNIX pot servir llocs web diferents en funció del port TCP del servidor al que es faci la petició.</p>
    <p>Configurarem dos llocs diferents: un si es fa la connexió al port <w>80</w>, 
        i l'altre si es fa la connexió al port <w>1234</w></p>


    <scfile>
        /etc/nginx/sites-enabled/default
    </scfile>
    <sc none>
        server {
            listen 80;
            root /var/www/html/aaa.com;
        }

        server {
            listen 1234;
            root /var/www/html/bbb.com;
        }
    </sc>

    <p>Accedim a <url>http://<IP_SERVIDOR>ip_servidor</IP_SERVIDOR>:80</url></p>
    <p>Accedim a <url>http://<IP_SERVIDOR>ip_servidor</IP_SERVIDOR>:1234</url></p>



    <warn>
        <p>Reestablim la configuració del lloc per defecte, per a deixar-la neta per al pas següent</p>
        <host></host>
        <shell>
            printf "server {\n\troot /var/www/html;\n}\n" > /etc/nginx/sites-enabled/default
        </shell>
    
    </warn>


    <h3>Path</h3>

    <p>Si no s'especifica cap arxiu en el <w>path</w>, 
        per defecte, el servidor NGINX servirà l'arxiu <w>index.html</w>, 
        o el que indiquem amb el paràmetre
        <w>index</w> de la configuració del lloc.
    </p>

    <p>Anem a crear diversos arxius al directory <folder>/var/www/html</folder>:</p>

    
        <host>@server</host>
        <shell>
            echo "&lt;h1&gt;Home page&lt;/h1&gt;" > /var/www/html/index.html
            echo "&lt;h1&gt;Pagina xxx &lt;/h1&gt;" > /var/www/html/xxx.html
            echo "&lt;h1&gt;Pagina yyy &lt;/h1&gt;" > /var/www/html/yyy.html
        </shell>
     

    <p>Si ara fem una petició al servidor sense indicar cap arxiu <url>http://<IP_SERVIDOR>ip_servidor</IP_SERVIDOR></url>
    el servidor ens enviarà l'arxiu <file>index.html</file> </p>

    <p>Si especifiquem algun arxiu a la petició (e.g. <url>http://<IP_SERVIDOR>ip_servidor</IP_SERVIDOR>/xxx.html</url>) Apache ens servirà aquest arxiu.</p>

    <p>Si l'arxiu que posem a la url (e.g. <url>http://<IP_SERVIDOR>ip_servidor</IP_SERVIDOR>/opq.html</url>) no existeix, apache ens servirà una 
    pàgina <strong>"Not Found"</strong></p>


    <p>Al <w>path</w> de la URL també es poden especificar els directoris on es troba l'arxiu que se solicita. NGINX
    buscarà aquest arxius a partir del <w>root</w>.</p>

    <p>Per exemple, si el <w>root</w> és <w>/var/www/html</w>, i fem aquesta petició: 
        <url>http://<IP_SERVIDOR>ip_servidor</IP_SERVIDOR>/aaa/bbb/mmm.html</url>, NGINX buscarà aquest arxiu 
        <w>/var/www/html/aaa/bbb/mmm.html</w>. Comprovem-ho:</p>

    
    <host>@server</host>
    <shell>
        mkdir -p /var/www/html/aaa/bbb/
        echo "&lt;h1&gt;Pagina mmm&lt;/h1&gt;" > /var/www/html/aaa/bbb/mmm.html
    </shell>
    
    
    <p>Comprova que s'accedeix al recurs <file>mmm.html</file> amb aquesta URL <url>http://<IP_SERVIDOR>ip_servidor</IP_SERVIDOR>/aaa/bbb/mmm.html</url>.</p>

    <p>Ara anem a canviar el <w>root</w>, i farem que sigui <folder>/var/www/html/aaa/</folder>:</p>

    <scfile>
        /etc/nginx/sites-enabled/default
    </scfile>
    <sc none>
        <low>
        server {
            ...
        </low>
        <add>
            root /var/www/html/aaa;
        </add>
        <low>
        }
        </low>
    </sc>

    <p>Reiniciem el servidor:</p>

    
        <host>@server</host>
        <shell>
            systemctl restart nginx
        </shell>
    

    <p>Ara, per a accedir al recurs <file>mmm.html</file>, la URL que cal posar és <url>http://<IP_SERVIDOR>ip_servidor</IP_SERVIDOR>/bbb/mmm.html</url>.</p>

    <warn>
        <p>Reestablim la configuració del lloc per defecte, per a deixar-la neta per al pas següent</p>
        <host></host>
        <shell>
            printf "server {\n\troot /var/www/html;\n}\n" > /etc/nginx/sites-enabled/default
        </shell>
    </warn>


    <h3>Query</h3>

    <p>La <w>query</w> serveix per a passar dades extra al recurs que s'està solicitant.</p>

    <p>Veiem un exmple:</p>

    <p>En aquesta url <a href="https://www.google.com/search?q=animals">https://www.google.com/search?q=animals</a>, estem passant al recurs <w>search</w> la dada extra 
    <w>q=animals</w>. Aquest recurs ja sabrà que fer amb aquesta dada extra. Si li passem una query que el recurs no sap 
    processar, normalment la ignorarà: 
    <a href="https://www.google.com/search?jajaja=jejeje">https://www.google.com/search?jajaja=jejeje</a>.</p>


    <p>Anem a fer al nostre contenidor un recurs que accepti una <w>query</w> amb dades extra i faci alguna cosa amb aquestes
    dades.</p>

    <p>Primer hem de comprendre que el recurs no pot ser una pàgina <w>HTML</w>, ja que el llenguatge HTML només és per a 
    definir el contingut de la pàgina. És a dir, amb HTML no podem accedir a les dades de la <w>query</w>.</p>

    <p>Un llenguatge que sí pot obtenir les dades de la <w>query</w> i fer alguna cosa amb aquestes dades es <w>PHP</w>.
    Anem a veure uns exemples simples amb el que es pot fer amb <w>PHP</w>.</p>

    <p>Primer l'instal·lem:</p>
    
    <host>@server</host>
    <shell>apt install -y php php-fpm</shell>
    

    <p>Afegirem la següent configuració al lloc NGINX:</p>
    <scfile>
        /etc/nginx/sites-enabled/default
    </scfile>
    <sc>
        <low>
        server {
            ...
            
        </low>
        <add>
            location ~ \.php$ {
                fastcgi_pass  127.0.0.1:9000;
                include fastcgi.conf;
            }
        </add>
        <low>
        }
        </low>

    </sc>

    <p>Configurem <w>php-fpm</w> per a escoltar al port 9000:</p>

    <scfile>
        /etc/php/7.4/fpm/pool.d/www.conf
    </scfile>
    <sc>
        <low>
        ...    
        </low>
        <rem>
        listen = /run/php/php7.4-fpm.sock
        </rem>
        <add>
        listen = 9000
        </add>
        <low>
        ...
        </low>

    </sc>

    <p>Reiniciem el servidor NGINX i PHP-FPM</p>

    <host>@server</host>
    <shell>
        systemctl restart php7.4-fpm nginx
    </shell>

    <p>Crearem un senzill script <w>php</w> que ens permetrà executar comandes al servidor a través del navegador web.</p>

    <img src="img/webash.png">

    <p>Anomenarem aquest recurs <strong>WEBASH</strong> (web + bash):</p>

    
        <host>@server</host>
        <shell>
            nano /var/www/html/webash.php
        </shell>
    

    <p>Afegim el següent codi a l'arxiu <file>webash.php</file>:</p>
    <scfile>
        /var/www/html/webash.php
    </scfile>
    <sc php>
        &lt;?php
        echo "&lt;style&gt; body { font-family: Consolas, monospace; }&lt;/style&gt;";
        echo "&lt;span style='font-size: 2em;'&gt;webash/&lt;/span&gt;";
        echo "&lt;span&gt;web&bash&lt/span&gt;";
        ?&gt;
    </sc>

    <p>Si accedim al recurs <w>http://<IP_SERVIDOR>ip_servidor</IP_SERVIDOR>/webash.php</w> veurem la pàgina generada per l'script <file>webash.php</file>:</p>

    <img src="img/webash2.png">

    <!--
    <observe>
        <p>Fixa't que el que fa l'script <w>php</w> és generar codi HTML amb els <w>echo</w>. Apache executa 
            l'script i retorna al navegador tot el que ha mostrar l'script amb els <w>echo</w>.</p>
        <p>Per a generar codi html posarem <w>echo</w>, el codi html entre cometes <w>""</w> i punt-i-coma <w>;</w>:</p>
        <sc php>
            echo "<replace>codi html</replace>";
        </sc>

        <p>Tot el codi PHP que escrivim ha d'anar dintre de les etiquetes <w>&lt;?php</w> i <w>?&gt;</w>:</p>

        <sc php>
            &lt;?php

            // codi PHP

            ?&gt;
        </sc>
    </observe>
-->
    <p>De moment, el nostre codi PHP sempre mostra el mateix contingut, independentment de la <w>query</w> que li passem.
    És a dir, posis les dades que posis a la <w>query</w>, l'script les ignorarà. Per exemple: 
    <url>http://<IP_SERVIDOR>ip_servidor</IP_SERVIDOR>/webash.php?comanda=pstree</url>, o <url>http://<IP_SERVIDOR>ip_servidor</IP_SERVIDOR>/webash.php?hola=quetal</url></p>

    <p>Anem a modificar l'script per que agafi una dada de la <w>query</w> i faci alguna cosa:</p>

    <p>Afegim aquestes línies de codi a l'arxiu <file>webash.php</file>:</p>
    <scfile>
        /var/www/html/webash.php
    </scfile>
    <sc php>
        <low>
        &lt;?php
        echo "&lt;style&gt; body { font-family: Consolas, monospace; }&lt;/style&gt;";
        echo "&lt;span style='font-size: 2em;'&gt;webash/&lt;/span&gt;";
        echo "&lt;span&gt;web&bash&lt/span&gt;";
        </low>
        <add>
        echo "&lt;h1&gt;Hola ";
        echo $_GET['usuari'];
        echo "&lt;/h1&gt;";
        </add>
        <low>
        ?&gt;
        </low>
    </sc>

    <p>Ara posem la query <w>usuari=gerard</w> a la url: <url>http://<IP_SERVIDOR>ip_servidor</IP_SERVIDOR>/webash.php?usuari=gerard</url>. 
    L'script php genera aquesta web:</p>

    <img src="img/webash3.png">

    <observe>
        <p>Amb el codi <w>$_GET['usuari']</w> de la línia <ln>7</ln>, hem obtingut el valor de la dada <w>usuari</w>
        de la query, i l'hem utilitzat per a generar el contingut de l'etiqueta <w>&lt;h1&gt;</w>.</p>

        <p>Si fas la query amb un altre valor per a la dada <w>usuari</w>, l'script generarà un altre codi html que 
        inclourà aquest valor.</p>

        <p>Per contra, si canvies la paraula <w>usuari</w> per una altra cosa, l'script ignorarà la dada.</p>

    </observe>

    <!--
    <p>Quan introduïm alguna cosa en el camp de text, per exemple <name>hola</name> i li donem al botó <mo>Executar</mo></p>
    -->
    <p>Avançarem amb el webash, i ara farem que quan a la query se li passi una dada anomenada <w>comanda</w>, l'script agafarà el valor
    d'aquesta dada i l'executarà al sistema operatiu, retornant el seu resultat.</p>

    <p>Esborra les línies anteriors, i afegeix aquestes línies:</p>
    <scfile>
        /var/www/html/webash.php
    </scfile>
    <sc php>
        <low>
        &lt;?php
        echo "&lt;style&gt; body { font-family: Consolas, monospace; }&lt;/style&gt;";
        echo "&lt;span style='font-size: 2em;'&gt;webash/&lt;/span&gt;";
        echo "&lt;span&gt;web&bash&lt/span&gt;";
        </low>
        <rem>
        echo "&lt;h1&gt;Hola ";
        echo $_GET['usuari'];
        echo "&lt;/h1&gt;";
        </rem>

        <add>
        echo "&lt;pre style='width: 80ch; padding: 2ch; overflow: auto; color: white; background: #300A24;'>";
        system("exec 2&gt;&1 && " . $_GET['comanda']);
        echo "&lt;/pre&gt;";
        </add>
        <low>
        ?&gt;
        </low>
    </sc>

    <p>Ara l'script agafarà el valor de la dada anomenada <w>comanda</w> i l'executarà. Per exemple podem executar 
    la <w>pstree</w> així: <url>http://<IP_SERVIDOR>ip_servidor</IP_SERVIDOR>/webash.php?comanda=df -h</url>:</p>

    <img src="img/webash5.png">

    <observe>
        <p>La funció <w>system</w> executa el que se li posi entre els parèntesi, i el resultat de la comanda, 
        s'inclou a la pàgina generada.</p>

        <p>El que està executant aleshores la funció <w>system</w> és el valor de la dada <w>comanda</w> de la query.
        Prova a posar aquesta url <url>http://<IP_SERVIDOR>ip_servidor</IP_SERVIDOR>/webash.php?comanda=cal</url> o qualsevol altra comanda a 
        la query.</p>
    </observe>
    

    <p>Per últim, afegirem a webash una forma més còmoda de realitzar comandes, que no sigui posant-les a la url.
        Afegirem un formulari amb un camp de text i un botó:
    </p>

    <scfile>
        /var/www/html/webash.php
    </scfile>
    <sc php>
        &lt;?php
        echo "&lt;style&gt; body { font-family: Consolas, monospace; }&lt;/style&gt;";
        echo "&lt;span style='font-size: 2em;'&gt;webash/&lt;/span&gt;";
        echo "&lt;span&gt;web&bash&lt/span&gt;";

        <add>
        echo "&lt;form&gt;";
        echo "&lt;input name='comanda'&gt";
        echo "&lt;input type='submit' value='Executar'&gt;";
        echo "&lt;/form&gt;";
        </add>
    
        echo "&lt;pre style='width: 80ch; padding: 2ch; overflow: auto; color: white; background: #300A24;'>";
        system($_GET['comanda']);
        echo "&lt;/pre&gt;";
        ?&gt;
    </sc>

    <p>Ara ens serà més còmode executar una comanda: </p>

    <img src="img/webash6.png">

    <p>Quan es premi el botó Executar, automàticament el navegador web agafarà els camps del <w>&lt;form&gt;</w> i els afegirà 
    a la query de la petició. Anomenarà les dades de la query segons l'atribut <w>name</w> dels <w>&lt;input&gt;</w> i el 
    valor serà el que s'hagi escrit en ells. Prova a executar algunes comandes!</p>

    <h3>Fragment</h3>
    <p>El <w>fragment</w> serveix per a fer que el navegador posicioni la pàgina en una secció determinada. Aquesta part
    de la url no arriba al servidor, és el navegador el qui ha de saber com gestionar el <w>fragment</w>.</p>

    <p>Veiem un exmple:</p>

    <p>Generem un arxiu html extens amb 5 seccions (<w>id=sX</w>) i 30 paràrafs en cada secció:</p>
    
        <host>@server</host>
        <shell>
            for i in {1..5}; do printf "&lt;h1 id='s$i'&gt;Seccio $i&lt;/h1&gt;; for j in {1..30}; do printf "&lt;p&gt;seccio $i, paràgraf $j&lt;/p&gt;"; done; done > /var/www/html/llarg.html
        </shell>
    

    <p>Prova a navegar directament a alguna de les seccions del document.</p>

    <observe>
        <p>Per a definir una secció en un document hem d'afegir l'atribut <w>id</w> a l'element que desitjem. 
        Per a navegar directament a una secció, només cal afegir un <w>#</w> seguit del valor del seu atribut <w>id</w>.</p>
    </observe>
</section>

<section>
    <h2>Servidor web</h2>

    <p>El servidor web és un software que respon a les peticions dels clients en la WWW. Un servidor web pot tenir un o més llocs
        web. 
    </p>

    <p>Hi ha una àmplia varitat de software que s'utilitza com a servidor web. Els que més quota de mercat tenen actualment són:
        <a href="https://httpd.apache.org/">Apache</a> (44.3%) i <a href="https://www.nginx.com/">nginx</a> (41%).
    </p>

    <h3>Servir recursos</h3>
    <p>La tasca principal d'un servidor web és respondre a les peticions HTTP amb els recursos solicitats.</p>

    <p>Els recursos que entrega el servidor web als clients són freqüentment fitxers amb codi HTML, codi CSS i codi Javascript.
        També pot enviar altres tipos de recursos com imatges, videos i arxius de tot tipus.
    </p>

    <img src="img/servidorweb response.png">

    <p>Veiem un exemple. Descarrega aquest 
        <a href="https://upload.wikimedia.org/wikipedia/commons/7/7b/What_is_the_future_of_the_internet-_-_Tim_Berners_Lee.webm">vídeo de Tim Berners-Lee</a>
         al directory <folder>/var/www/html</folder> del servidor:</p>
    
    <host>@host</host>
    <shell>wget -O /var/www/html/tim.webm https://upload.wikimedia.org/wikipedia/commons/7/7b/What_is_the_future_of_the_internet-_-_Tim_Berners_Lee.webm</shell>

    <p>Utilitza el client Firefox per a fer una petició d'aquest recurs al servidor: <url>http://10.2.4.100/tim.webm</url>.</p>

    <h3>Estàtic vs Dinàmic</h3>

    <p>Un servidor web pot servir contingut estàtic o dinàmic:</p>
    <ul>
        <li><p>Estàtic es refereix a que el servidor envia el recurs solicitat tal qual, sense processar-lo.</p></li>
        <li><p>Dinàmic es refereix a que el servidor per a respondre a una solicitud executa un script que genera el recurs,
            de forma que el recurs pot ser diferent en cada execució. Els scripts que generen recursos poden estar escrits 
            en molts llenguatges de programació com <w>PHP</w>, <w>Python</w>, <w>Java</w>, <w>JavaScript</w>, <w>ASP</w>, i un 
            llarg etcètera.</p></li>
    </ul>

    <img src="img/servidorwebdinamic.png">


    <p>Veiem un exemple: Serverdate</p>

    <p>Crea aquest arxiu al servidor:</p>

    <scfile>
        /var/www/html/serverdate.html
    </scfile>
    <sc html>
        &lt;!DOCTYPE html&gt;
        &lt;p&gt;La data del servidor es: Tue Oct 20 10:13:08 UTC 2020&lt;/p&gt;
    </sc>
   
    <p>Navega a <url>http://10.2.1.24/serverdate.html</url></p>

    <p>El recurs <file>serverdate.html</file> és un recurs estàtic. El servidor web el servirà tal qual, per això encara que 
    recarregis la pàgina, la data/hora no canviarà.</p>

    <p>Provem a fer un continugt dinàmic:</p>

    <host>@server</host>
    <shell>apt install -y php php-fpm</shell>
    

    <p>Afegirem la següent configuració al lloc NGINX:</p>
    <scfile>
        /etc/nginx/sites-enabled/default
    </scfile>
    <sc>
        <low>
        server {
            ...
            
        </low>
        <add>
            location ~ \.php$ {
                fastcgi_pass  127.0.0.1:9000;
                include fastcgi.conf;
            }
        </add>
        <low>
        }
        </low>

    </sc>

    <p>Configurem <w>php-fpm</w> per a escoltar al port 9000:</p>

    <scfile>
        /etc/php/7.4/fpm/pool.d/www.conf
    </scfile>
    <sc>
        <low>
        ...    
        </low>
        <rem>
        listen = /run/php/php7.4-fpm.sock
        </rem>
        <add>
        listen = 9000
        </add>
        <low>
        ...
        </low>

    </sc>

    <p>Reiniciem el servidor NGINX i PHP-FPM</p>

    <host>@server</host>
    <shell>
        systemctl restart php7.4-fpm nginx
    </shell>

    <p>Escriu aquest script PHP:</p>

    <scfile>
        /var/www/html/serverdate.php
    </scfile>
    <sc php>
        &lt;?php
        echo "&lt;p&gt;La data del servidor es: ";
        system(date);
        echo "&lt;/p&gt";
        ?&gt;
    </sc>

    <p>Ara, cada vegada que navegues al recurs <url>http://10.1.2.23/serverdate.php</url> el servidor web executa
    l'script i envia al client el recurs resultant. La comanda <w>system(date)</w> obté l'hora actual del servidor, per tant
    cada vegada que recarreguis la pàgina, obtindràs l'hora actual.</p>

    <h3>Base de dades</h3>
    <p>La majoria d'aplicacions web utilitzen una base de dades per a emmagatzemar la informació que han de mostrar.
        Els scripts poden guardar i obtenir la informació d'elles (com per exemple, les publicacions que fan els usuaris 
        a una xarxa social).
    </p>

    <img src="img/phpdb.png">

    <p>Farem una aplicació web anomenada <w>TheWall</w> on els visitants podran escriure una firma, i totes les firmes que es vagin posant es mostraran a la
        pàgina.</p>

    <p>Instal·la el gestor de bases de dades MySQL:</p>

    <host>@server</host>
    <shell>
        wget https://repo.mysql.com//mysql-apt-config_0.8.18-1_all.deb
        apt install -y ./mysql-apt-config_0.8.18-1_all.deb
        apt update
        apt install mysql-server
    </shell>

    <p>Crearem una base de dades per a la app <w>TheWall</w>:</p>

    <host>@server</host>
    <shell>mysql -e "CREATE DATABASE thewalldb"</shell>

    <p>Ara crearem un usuari per a administrar aquesta base de dades:</p>

    <host>@server</host>
    <shell>mysql -e "CREATE USER 'thewalldbadmin'@'localhost' IDENTIFIED BY 'pass123'"</shell>

    <p>Li donem privilegis a l'usuari <w>thewalldbadmin</w> per a administrar la base de dades <w>thewalldb</w>:</p>
    <host>@server</host>
    <shell>mysql -e "GRANT ALL PRIVILEGES ON thewalldb.* TO 'thewalldbadmin'@'localhost'; FLUSH PRIVILEGES"</shell>

    <p>El més habitual és que les bases de dades emmagatzemin la informació en taules. Per a la nostra app crearem una taula
        <w>firmes</w> on es s'aniran guardant les firmes dels visitants. Aquesta taula només tindrà un camp que contindrà una <w>firma</w>.
    </p>
    <host>@server</host>
    <shell>mysql -e "CREATE TABLE thewalldb.firmes(firma TEXT)"</shell>
    
    <p>Insertarem unes quantes firmes de mostra a la taula <w>firmes</w>:</p>
    <host>@server</host>
    <shell>
        mysql -e "INSERT INTO thewalldb.firmes VALUES('hola que tal')"
        mysql -e "INSERT INTO thewalldb.firmes VALUES('pasaba por aqui')"
        mysql -e "INSERT INTO thewalldb.firmes VALUES('jajajaaajaaa')"
        mysql -e "INSERT INTO thewalldb.firmes VALUES('que hay que poner aqui?')"
    </shell>

    <p>Podem veure que les firmes s'han introduït a la taula <w>firmes</w> així:</p>
    <host>@server</host>
    <shell>
        mysql -e "SELECT * FROM thewalldb.firmes"
    </shell>

    <img src="img/select.png">
   
    <p>Ara el següent pas es programar un script PHP que obtingui la informació de la base de dades i la posi en la pàgina web
        que generi.
    </p>

    <p>Insal·larem el paquet <w>php-mysql</w> que permet connectar a una base de dades MySQL des d'un script PHP:</p>
    <host>@server</host>
    <shell>
        apt install -y php-mysql
    </shell>

    <p>L'script que connecta a la base de dades <w>thewalldb</w>, obté totes les firmes i les volca a la pàgina és aquest:</p>
    <scfile>
        /var/www/html/thewall.php
    </scfile>
    <sc php>
        &lt;style&gt; p, input { font-family: sans; padding: 1em; border-radius: .75em; border: 1px solid #deaeae;} &lt;/style&gt;
        &lt;?php
        $db = new mysqli("localhost", "thewalldbadmin", "pass123", "thewalldb");

        foreach ($db->query("SELECT * FROM firmes") as $fila) {
            echo "&lt;p&gt;".$fila['firma'];
        }
        ?&gt;
    </sc>

    <!--
    <ul>
        <li><p>A la línia <ln>2</ln> connectem amb la base de dades <w>thewalldb</w></p></li>
        <li><p>De <ln>4</ln> a <ln>6</ln >iterem per cada fila de la taula <w>firmes</w> 
            i volquem el camp <w>firma</w> de cada fila a la pàgina</li>
    </ul>
    -->

    <p>Naveguem a <url>http://<IP_SERVIDOR>ip_servidor</IP_SERVIDOR>/thewall.php</url> i veurem com l'script ha volcat totes les firmes que hi ha a la base de dades:</p>

    <img src="img/thewall.png">

    <p>Aquest contingut és dinàmic: depèn del contingut de la base de dades. Ho podem comprovar afegint més 
        firmes a la base de dades:
    </p>
    <host>@server</host>
    <shell>
        mysql -e "INSERT INTO thewalldb.firmes VALUES('te quiero')"
        mysql -e "INSERT INTO thewalldb.firmes VALUES('que pasa?')"
        mysql -e "INSERT INTO thewalldb.firmes VALUES('nunca te olvidare')"
    </shell>

    <p>Acabarem l'script <w>thewall</w> permetent que els visitants escriguin la seva firma. Aquesta firma s'enviarà a l'script
    en la <w>query</w>, i l'script l'obtindrà i la guardarà a la base de dades.</p>
    <scfile>
        /var/www/html/thewall.php
    </scfile>
    <sc php>
        <low>
        &lt;style&gt; p, input { font-family: sans; padding: 1em; border-radius: .75em; border: 1px solid #deaeae;} &lt;/style&gt;
        </low>
        <add>
        &lt;form&gt;
            &lt;input name="firma"&gt;
            &lt;input type="submit" value="Firmar"&gt;
        &lt;/form&gt;
        </add>

        &lt;?php
        $db = new mysqli("localhost", "thewalldbadmin", "pass123", "thewalldb");

        <add>
        if (isset($_GET["firma"])) {
            $stmt = $db-&gt;prepare("INSERT INTO firmes VALUES(?)");
            $stmt-&gt;bind_param("s", $_GET["firma"]);
            $stmt-&gt;execute();
            $stmt-&gt;close();
        }
        </add>
        <low>
        foreach ($db-&gt;query("SELECT * FROM firmes") as $fila) {
            echo $fila['firma'];
        }
        ?&gt;
        </low>
    </sc>

    <!--
    <ul>
        <li><p>De <ln>1</ln> a <ln>4</ln> mostrem el formulari</p></li>
        <li><p>A <ln>9</ln> mirem si ens ha arribat una firma</p></li>
        <li><p>Si ens ha arribat la firma, la inserim a la base de dades (<ln>10</ln> - <ln>13</ln>)</p></li>
    </ul>
    -->
</section>

<section>
    <h2>NGINX Config</h2>

    <h3>rewrite</h3>

    <p><a href="http://nginx.org/en/docs/http/ngx_http_rewrite_module.html">http://nginx.org/en/docs/http/ngx_http_rewrite_module.html</a></p>

    <scfile>
        /etc/nginx/sites-enabled/default
    </scfile>
    <sc>        
        server {
            root /var/www/html;
            
            location / {
                rewrite ^/$ /index.php last;
                rewrite ^(.*)$ $1.php last;
            }

            location ~ \.php$ {
                fastcgi_pass backend;
                include fastcgi.conf;
            }
        }
    </sc>

    <h3>Load balancing</h3>

    <scfile>
        /etc/nginx/sites-enabled/default
    </scfile>
    <sc>
        upstream backend {
            server 192.168.122.<replace>XXX</replace>:9000;
            server 192.168.122.<replace>YYY</replace>:9000;
        }
        
        server {
            root /var/www/html;
        
            location ~ \.php$ {
                fastcgi_pass backend;
                include fastcgi.conf;
            }
        }
    </sc>

    <h3>https</h3>

    <p>Generar el certificat i la clau privada</p>

    <host>@server</host>
    <shell>
        openssl req -x509 -nodes -days 365 -newkey rsa:2048 -subj '/CN=192.168.122.<replace>XXX</replace>' -keyout /etc/ssl/private/site.key -out /etc/ssl/certs/site.pem
    </shell>

    <scfile>
        /etc/nginx/sites-enabled/default
    </scfile>
    <sc>
        <low>
        server {
        </low>
        <add>
            listen 443 ssl;
            ssl_certificate /etc/ssl/certs/site.pem;
            ssl_certificate_key /etc/ssl/private/site.key;
        </add>
        <low>
            ...
        }
        </low>
    </sc>
</section>

<section>
    <h2>Protocol http</h2>

    <h3>Method</h3>

    <p>POST</p>
    <sc php>
        &lt;!DOCTYPE html&gt;

        &lt;form method=&quot;POST&quot;&gt;
            &lt;input type=&quot;text&quot; name=&quot;identificador&quot;&gt;
            &lt;input type=&quot;submit&quot;&gt;
        &lt;/form&gt;
        &lt;?php
            echo &quot;&lt;h1&gt;Hola, &quot;.$_POST[&quot;identificador&quot;].&quot;!&lt;/h1&gt;&quot;
        ?&gt;
    </sc>

    <p>POST multipart/formdata</p>

    <sc php>

        &lt;!DOCTYPE html&gt;
        &lt;meta charset=&quot;UTF-8&quot;&gt;
        &lt;title&gt;File Manager&lt;/title&gt;

        &lt;style&gt;
        html {
            font-family: sans;
        }

        h1 {
            color: gray;
            border-bottom: 1px solid gray;
            padding-bottom: 16px;
        }

        a {
            text-decoration: none;
            color: inherit;
        }

        .file-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, 200px);
            grid-template-rows: repeat(auto-fill, 250px);
            grid-gap: 1em;
        }

        .file {
                display: flex;
                flex-direction: column;
                justify-content: flex-end;
        }

        .file a {
                display: flex;
                flex-direction: column;
                align-items: center;
        }

        .file p {
            text-align: center;
        }

        img {
            max-width: 80%;
            max-height: 80%;
            box-shadow: 0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23);
        }

        label {
            background-color: #55acee;
            color: white;
            border: 0px;
            border-radius: 4px;
            padding: 16px;
            margin-bottom: 24px;
        }

        .trash {
            background-image: url(data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9JzMwMHB4JyB3aWR0aD0nMzAwcHgnICBmaWxsPSIjMDAwMDAwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGRhdGEtbmFtZT0iTGF5ZXIgMSIgdmlld0JveD0iMCAwIDk2IDk2IiB4PSIwcHgiIHk9IjBweCI+PHRpdGxlPkFydGJvYXJkIDY2PC90aXRsZT48cG9seWdvbiBwb2ludHM9IjQwLjc4IDY2IDU1LjIyIDY2IDU3Ljc2IDQ0IDM4LjI0IDQ0IDQwLjc4IDY2Ij48L3BvbHlnb24+PHBvbHlnb24gcG9pbnRzPSI0NC4yNCAzMSA0My4yNCAzMyA1Mi43NiAzMyA1MS43NiAzMSA0NC4yNCAzMSI+PC9wb2x5Z29uPjxwYXRoIGQ9Ik00OCwyQTQ2LDQ2LDAsMSwwLDk0LDQ4LDQ2LDQ2LDAsMCwwLDQ4LDJaTTYyLDQyLjIzbC0zLDI2QTIsMiwwLDAsMSw1Nyw3MEgzOWEyLDIsMCwwLDEtMi0xLjc3bC0zLTI2YTIsMiwwLDAsMSwuNS0xLjU2QTIsMiwwLDAsMSwzNiw0MEg2MGEyLDIsMCwwLDEsMS40OS42N0EyLDIsMCwwLDEsNjIsNDIuMjNaTTYzLDM3SDMzYTIsMiwwLDAsMSwwLTRoNS43NmwyLjQ1LTQuODlBMiwyLDAsMCwxLDQzLDI3SDUzYTIsMiwwLDAsMSwxLjc5LDEuMTFMNTcuMjQsMzNINjNhMiwyLDAsMCwxLDAsNFoiPjwvcGF0aD48L3N2Zz4=);
            background-size: contain;
            width: 30px;
            height: 30px;
            display: block;
            position: relative;
            top: -80px;
            left: -6px;
        }

        input[type=file] {
            display: none;
        }

        &lt;/style&gt;

        &lt;h1&gt;&amp;#128194; File manager&lt;/h1&gt;
        &lt;form id=&quot;upload-form&quot; enctype=&quot;multipart/form-data&quot; method=&quot;POST&quot;&gt;
            &lt;input id=&quot;file&quot; name=&quot;userfile&quot; type=&quot;file&quot; onchange=&quot;document.getElementById(&#39;upload-form&#39;).submit()&quot;/&gt;
            &lt;label for=&quot;file&quot;&gt;Upload file...&lt;/label&gt;
        &lt;/form&gt;

        &lt;?php
        if(isset($_FILES[&#39;userfile&#39;])){
            move_uploaded_file($_FILES[&#39;userfile&#39;][&#39;tmp_name&#39;], &#39;uploads/&#39; . $_FILES[&#39;userfile&#39;][&#39;name&#39;]);
        }

        if(isset($_GET[&#39;delete&#39;])){
            unlink(&#39;uploads/&#39; . $_GET[&#39;delete&#39;]);
        }
        ?&gt;

        &lt;div class=&quot;file-grid&quot;&gt;
        &lt;?php
        if ($handle = opendir(&#39;uploads/&#39;)) {
            while (($file = readdir($handle))) {
                if ($file != &quot;.&quot; &amp;&amp; $file != &quot;..&quot;) {
                    echo &quot;
                    &lt;div class=&#39;file&#39;&gt;
                        &lt;a href=&#39;uploads/$file&#39;&gt;
                            &lt;img src=&#39;uploads/$file&#39;&gt;
                            &lt;p&gt;$file&lt;/p&gt;
                        &lt;/a&gt;
                        &lt;a class=&#39;trash&#39; href=&#39;?delete=$file&#39;&gt;&lt;/a&gt;
                    &lt;/div&gt;
                &quot;;
                }
            }
            closedir($handle);
        }
        ?&gt;
        &lt;/div&gt;
    </sc>

    <h3>Cookies</h3>

    <p><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies">https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies</a></p>

    <shell>
        nc -l 8000
    </shell>

    <sc>
        HTTP/1.0 200 OK
        Content-Type: text/html
        Set-Cookie: una_cookie=choco
        Set-Cookie: una_altra_cookie=strawberry

        &lt;a href=&quot;/&quot;&gt;Tornar&lt;/a&gt;
        &lt;h1&gt;Hello&lt;/h1&gt;
    </sc>

    <sc php>
        &lt;form&gt;
            &lt;input type=&quot;color&quot; name=&quot;favcolor&quot;&gt;
            &lt;input type=&quot;submit&quot;&gt;
        &lt;/form&gt;
        &lt;?php
                if(isset($_GET[&#39;favcolor&#39;])){
                        setcookie(&quot;color&quot;, $_GET[&#39;favcolor&#39;]);
                }
        ?&gt;
        
        &lt;style&gt;
        body { background: &lt;?php echo $_COOKIE[&#39;color&#39;] ?&gt; }
        &lt;/style&gt;
            
    </sc>

    <h3>Location</h3>

    <shell>
        nc -l 8000
    </shell>

    <sc>
        HTTP/1.0 303 OK
        Location: https://wikipedia.org
    </sc>

    <sc php>
        &lt;?php
        header(&quot;location: login.php&quot;);
        ?&gt;
    </sc>
</section>
<!--
<section>
    <h2>Client web</h2>

    <p>Un client web és un software per a realitzar peticions HTTP a un servidor web.</p>

    <p>Els navegadors web són clients web que connecten a un servidor, descarreguen les seves pàgines i les mostren a l'usuari.</p>

    <p>També hi ha altres clients web que només descarreguen les pàgines d'un servidor, sense mostrar-les. Un exemple d'aquests 
        clients són <w>wget</w> i <w>curl</w>. Són dos programes de consola capaços de descarregar una pàgina web o un 
        altre recurs. Veiem un exemple d'ús <w>wget</w>:</p>

    <host>@server</host>
    <shell>wget info.cern.ch</shell>

    <p>Amb aquesta comanda, <w>wget</w> ha realitzat la petició al servidor <url>info.cern.ch</url> i ha guardat la pàgina. Podem
    veure el contingut de la pàgina amb aquesta comanda:</p>

    <host>@server</host>
    <shell>cat index.html</shell>

    <p>El que veiem és el codi HTML de la pàgina <file>index.html</file>.</p>

    <p>Els navegadors web, a més de descarregar la pàgina, interpreten el codi HTML i el mostren a l'usuari, permetent-li 
        navegar dintre d'ella o fer click als seus enllaços per a navegar a altres pàgines.
    </p>

    <p>Hi ha navegadors web que s'executen en mode gràfic (Firefox, Chrome, etc.) i altres que es poden executar a 
        la consola en mode text. Alguns exemples són: <w>lynx</w>, <w>w3m</w>, <w>browsh</w>. Provem el lynx:</p>

    <host>@host</host>
    <shell>apt install lynx</shell>

    <host>@host</host>
    <shell>lynx info.cern.ch</shell>

    <h3>Pàgines web</h3>
    <p>Les pàgines web són una colecció d'informació que consisteix en un o més fitxers de text escrits en HTML. Les pàgines
        web també poden fer ús de codi JavaScript, i codi CSS:
    </p>
    <ul>
        <li><p>El codi HTML descriu el contingut i estructura d'una pàgina web. El contingut pot ser text, imatges, vídeos, etc.</p></li>
        <li><p>El codi CSS descriu la presentació de la pàgina.</p></li>
        <li><p>El codi JavaScript descriu el comportament de la pàgina.</p></li>
    </ul>

    <p>Veiem un petit exemple:</p>

    <scfile>
        index.html
    </scfile>
    <sc html>
        &lt;p&gt;HTML &amp; CSS &amp; JavaScript&lt;/p&gt;

        &lt;style&gt;
            @import url(&#39;https://fonts.googleapis.com/css2?family=Gloria+Hallelujah&#39;);

            p {
                font-family: &#39;Gloria Hallelujah&#39;;
                font-size: 48px;
                color: #f7d21f;
                font-weight: bold;
            }
        &lt;/style&gt;

        &lt;script&gt;
            setInterval(() =&gt; {
                document.body.insertAdjacentHTML(&#39;beforeend&#39;, &#39;&lt;img src=&quot;https://raw.githubusercontent.com/smxm8/static/main/homer.png&quot;&#39;);
            }, 1000);
        &lt;/script&gt;
    </sc>

</section>
-->